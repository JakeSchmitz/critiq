<%= nested_form_for @product, :html => { :class => 'form-horizontal span8', :multipart => true } do |f| %>
  <div class="control-group">
    <%= f.label :name, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_field :name, :class => 'text_field' %>
    </div>
  </div>
  <%= f.fields_for @product.pictures.build, :html => { :multipart => true } do |picture| %>
    <% if picture.object.new_record? %>
      <div class="control-group">
        <%= picture.label "Image", :class => 'control-label' %>
        <div class="controls btn file_upload_wrapper"  style="float: left; display: inline">
          <%= file_field_tag :attachment, multiple: true,  name: 'upload[uploaded_file]'  %>
        </div>
      </div>  
    <% end %>
  <% end %>
  <div class="control-group">
    <%= f.label :description, :class => 'control-label' %>
    <div class="controls">
      <%= f.text_area :description, maxlength: 1000, :class => 'text_field', style: 'height: 200px;' %>
    </div>
  </div>

  <div class="form-actions">
    <%= f.submit nil, :class => 'btn btn-primary' %>
    <%= link_to t('.cancel', :default => t("helpers.links.cancel")),
                products_path, :class => 'btn' %>
  </div>
<% end %>

<% # jquery upload template # %>
<script id="template-upload" type="text/x-tmpl"><div class="upload">{%=o.name%}<div class="progress"><div class="bar" style="width: 0%"></div></div></div></script>

