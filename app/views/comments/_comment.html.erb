<div class="<%= comment.parent ? 'comment nested-comment' : 'comment' %>">

	
	<div class="comment-body pull-right" style="padding: 0px;width: <%= 750 - comment.depth * 38 %>px">
		<div class="commenter-info">
			<div class="user-thumb-pic" style="width: 29px; height: 29px; display: inline-block;">
				<div class="thumb-ratio" style="background-image: url('<%= comment.user.profile_pic_url(:medium) %>');"></div>
			</div>
			<p style="display: inline-block; vertical-align: top; margin-top: 5px;"><%= link_to comment.user.name, user_path(comment.user) %> - <%= time_ago_in_words(comment.created_at).gsub('about','') + ' ago' %> - 
				<% commentable = @commentable if @commentable %>
				<%= link_to "Reply", polymorphic_url(comment.path_to_reply, action: :new, parent_id: comment.id), remote: true, :class => "reply" %> - 
				<%= link_to "Collapse", nil, :class => "shrink" %> 
				<% if signed_in? and (current_user.id == comment.user.id or is_admin?) %>
					<%= link_to "Delete", polymorphic_url(comment.path_to_delete), method: :destroy %>
				<% end %>
			</p>
		</div>
		<p style="float: left; padding: 5px 10px 5px 10px;"><%= comment.body %></p>
	</div>
	<div class="user-info pull-right">
	</div>
	<div class="comment-vote-buttons pull-right">
		<a href=<%= comment_vote_path(:product_id => product.id, :comment_id => comment.id, up: true)%> id="commentUpvote<%= comment.id %>" data-remote="true">
			<i class="fa fa-play fa-rotate-270" style="color: #1ba573;"></i>
		</a>
		<h5 style="margin: 0px;" id="commentRating<%= comment.id %>"><%= comment.rating %></h5>
		<a href=<%= comment_vote_path(:product_id => product.id, :comment_id => comment.id, up: false)%> id="commentDownvote<%= comment.id %>" data-remote="true">
			<i class="fa fa-play fa-rotate-90"  style="color: #c14b1b;"></i>
		</a>
	</div>
	<div class="reply-section" >
	</div>
</div>
<%= render partial: 'comments/collapsed_comment', locals: { comment: comment} %>

<script>
  $(document).ready(function(){
    $('#commentUpvote<%= comment.id.to_s %>')
      .bind("ajax:beforeSend", function(evt, xhr, settings){
        console.log('attempting to Upvote comment');
      }).bind("ajax:complete", function(evt, data, status, xhr) {
        console.log('successfully upvoted comment');
        var comment = jQuery.parseJSON(data.responseText);
        $('#commentRating<%= comment.id %>').html(String(comment.rating));
      });
    $('#commentDownvote<%= comment.id.to_s %>')
      .bind("ajax:beforeSend", function(evt, xhr, settings){
        console.log('attempting to downvote comment');
      }).bind("ajax:complete", function(evt, data, status, xhr) {
        console.log('successfully downvoted comment');
        var comment = jQuery.parseJSON(data.responseText);
        $('#commentRating<%= comment.id %>').html(String(comment.rating));
      });
  });
</script>